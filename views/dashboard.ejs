<div class="page-header">
    <h2 class="page-title">Health Surveillance Dashboard</h2>
    <div class="last-updated">
        Last updated: <span id="lastUpdated"><%= new Date().toLocaleString() %></span>
    </div>
</div>

<div class="stats-grid">
    <div class="stat-card blue">
        <div class="stat-content">
            <div class="stat-info">
                <p class="stat-label">Total Cases</p>
                <p class="stat-value"><%= stats.totalCases %></p>
            </div>
            <div class="stat-icon">
                <i class="fas fa-users"></i>
            </div>
        </div>
        <div class="stat-change">
            <span class="change-badge up">+12%</span>
        </div>
    </div>

    <div class="stat-card red">
        <div class="stat-content">
            <div class="stat-info">
                <p class="stat-label">Active Alerts</p>
                <p class="stat-value"><%= stats.activeAlerts %></p>
            </div>
            <div class="stat-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
        </div>
        <div class="stat-change">
            <span class="change-badge up">+5</span>
        </div>
    </div>

    <div class="stat-card green">
        <div class="stat-content">
            <div class="stat-info">
                <p class="stat-label">Water Sources Monitored</p>
                <p class="stat-value"><%= stats.waterSources %></p>
            </div>
            <div class="stat-icon">
                <i class="fas fa-map-marker-alt"></i>
            </div>
        </div>
        <div class="stat-change">
            <span class="change-badge safe">98%</span>
        </div>
    </div>

    <div class="stat-card yellow">
        <div class="stat-content">
            <div class="stat-info">
                <p class="stat-label">Current Risk Level</p>
                <p class="stat-value"><%= stats.riskLevel %></p>
            </div>
            <div class="stat-icon">
                <i class="fas fa-chart-line"></i>
            </div>
        </div>
        <div class="stat-change">
            <span class="change-badge stable">Stable</span>
        </div>
    </div>
</div>

<div class="dashboard-grid">
    <div class="dashboard-card">
        <h3 class="card-title">Outbreak Hotspots</h3>
        <div class="outbreak-map">
            <div class="map-controls" style="display:flex;justify-content:flex-end;gap:0.5rem;margin-bottom:0.5rem;align-items:center;">
                <label for="outbreakMonthSelect" style="margin-right:0.5rem;">Month:</label>
                <select id="outbreakMonthSelect" style="padding:0.35rem 0.5rem;border:1px solid #d1d5db;border-radius:0.375rem;background:#fff;"></select>
            </div>
            <div id="map"></div>
            <div class="map-legend">
                <div class="legend-item">
                    <div class="legend-color high-risk"></div>
                    <span>High Risk</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color medium-risk"></div>
                    <span>Medium Risk</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color low-risk"></div>
                    <span>Low Risk</span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="dashboard-card">
        <h3 class="card-title">Trend Analysis</h3>
        <div class="trend-chart">
            <div class="chart-header">
                <div class="chart-info">
                    <i class="fas fa-calendar"></i>
                    <span id="trendHeaderYear">Monthly Trend</span>
                </div>
                <div class="trend-indicator">
                    <i class="fas fa-trending-up"></i>
                    <span>+23% vs last year</span>
                </div>
            </div>
            <div class="chart-container" id="trendChartContainer">
            </div>
        </div>
    </div>
</div>

<!-- <div class="recent-alerts">
    <h3 class="section-title">Recent Alerts & Notifications</h3>
    <div class="alerts-list">
        <% alerts.forEach(alert => { %>
        <div class="alert-item <%= alert.severity %>">
            <div class="alert-content">
                <div class="alert-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <div class="alert-details">
                    <h4 class="alert-title"><%= alert.title %></h4>
                    <div class="alert-meta">
                        <span class="alert-location">
                            <i class="fas fa-map-marker-alt"></i>
                            <%= alert.location %>
                        </span>
                        <% if (alert.affectedCount > 0) { %>
                        <span class="alert-affected">
                            <i class="fas fa-users"></i>
                            <%= alert.affectedCount %> affected
                        </span>
                        <% } %>
                        <span class="alert-time">
                            <i class="fas fa-clock"></i>
                            <%= alert.time %>
                        </span>
                    </div>
                </div>
            </div>
            <div class="alert-status <%= alert.status %>">
                <%= alert.status %>
            </div>
        </div>
        <% }); %>
    </div>
</div> -->

<script>
document.addEventListener('DOMContentLoaded', function() {
    initializeCharts();
    initializeMap();
    startRealTimeUpdates();
});
</script>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="/js/map.js"></script>