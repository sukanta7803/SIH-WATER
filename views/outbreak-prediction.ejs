<div class="dashboard-grid">
  <div class="dashboard-card">
    <h3 class="card-title">Hotspot Map</h3>
    <% if (mapPath) { %>
      <div class="outbreak-map">
        <iframe src="<%= mapPath %>" class="prediction-map" title="Outbreak Hotspots"></iframe>
      </div>
    <% } else { %>
      <div class="alert alert-info">Map is not available.</div>
    <% } %>
  </div>
</div>

<div class="dashboard-card" style="margin-top:1rem;">
  <h3 class="card-title">Outbreak Predictions</h3>
  <% if ((redzones || []).length === 0) { %>
    <div class="alert alert-info">No data available.</div>
  <% } else { %>
    <div class="table-wrapper prediction-table-wrapper">
      <table class="prediction-table">
        <thead>
          <tr>
            <th>Risk</th>
            <th>District</th>
            <th>Disease</th>
            <th>Date</th>
          </tr>
        </thead>
        <tbody>
          <% redzones.forEach(function(r){
              const pct = Number(r.percentage || 0);
              const riskClass = pct >= 70 ? 'high' : (pct >= 40 ? 'medium' : 'low');
              const dateStr = r.date ? (new Date(r.date)).toLocaleDateString() : (new Date()).toLocaleDateString();
              const districtClean = (r.district || '').replace(/^[^A-Za-z0-9]+\s*/, '');
          %>
            <tr>
              <td>
                <span class="risk-badge <%= riskClass %>"><%= pct %>%</span>
              </td>
              <td><%= districtClean %></td>
              <td><%= r.disease %></td>
              <td><%= dateStr %></td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  <% } %>
</div>
